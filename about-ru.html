<!DOCTYPE html>
<html><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>About Investment Portfolio Dashboard</title>

<meta name="viewport" content="width=device-width, initial-scale=1.0">

<meta property="og:title" content="Investment Portfolio Dashboard is a sample solution for personal portfolio management, created using AnyChart charting framework"/>
<meta property="og:description" content="Our dashboard is minimalistic, but it can be easily extended, and it does not matter how much additional information you need to show: our charting framework is flexible enough to cope with any task."/>
<meta property="og:image" content="src/i/screen.jpg"/>

<link rel="icon" href="src/i/anychart.ico">
<link rel="stylesheet" type="text/css" href="src/vendors/bootstrap-3/bootstrap.min.css">
<link rel="stylesheet" type="text/css" href="src/vendors/font-awesome-4.4.0/css/font-awesome.min.css">
<link rel="stylesheet" type="text/css" href="src/css/styles.css">
<link rel="stylesheet" type="text/css" href="src/css/prettify-tomorrow.css">
</head>

<body>
<div class="container-fluid">
<div class="row title-panel">
<div class="col-lg-12">
<h1 class="title"> <a class="navbar-brand" href="//anychart.com/"> <img src="src/i/AnyChart-light-empty.png" alt="AnyChart" height="72" width="300">
<div class="chart-row"> <span class="chart-col green"></span><span class="chart-col orange"></span> <span class="chart-col red"></span> </div>
</a> Creation Investment Portfolio Dashboard Process <span class="btn-group pull-right submenu"> <a type="button" class="btn btn-link dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"> </a>
<ul class="dropdown-menu">
<li><a href="http://anychart.com/support/" target="_blank">Support</a></li>
<li><a href="https://github.com/AnyChart/investment-portfolio-dashboard/archive/master.zip">
Download .zip</a></li>
<li><a href="https://github.com/AnyChart/investment-portfolio-dashboard">
GitHub Project</a></li>
</ul>
</span> </h1>
</div>
</div>
<div class="article">
<div class="row">
<div class="col-sm-12"> <a class="btn btn-primary btn-back" href="index.html">Back
to Dashboard</a>
</div>
<div class="col-sm-12">
<ol class="content">
<li><a href="#overview">Overview</a></li>
<li><a href="#design">Design</a>
<ul>
<li><a href="#concept">Dashboard Concept</a></li>
<li><a href="#data_search">Choice of the Data </a></li>
<li><a href="#layout_draft">Forming of the
Visual Presentation</a></li>
</ul>
</li>
<li><a href="#implementation">Implementation</a>
<ul>
<li><a href="#converting_data">Convert Data</a></li>
<li><a href="#layout_technology">Layout
Technology Stack</a></li>
<li><a href="#creation">Creation Charts with
AnyChart</a></li>
<li><a href="#enjoying">Enjoying the Result</a></li>
</ul>
</li>
<li><a href="#licence">Licence</a></li>
</ol>
</div>
</div>
<div class="row">
<div class="col-sm-12">
<h1 id="overview">Введение</h1>
<p>В этом туториале мы расскажем, как с помощью библиотеки
AnyChart создать дашборд (dashboard), который можно использовать в
веб-приложениях для управления инвестицонными портфелями. Для того,
чтобы пример был понятен, мы создадим самый простой дашборд, однако
пример можно легко расширить и превратить в полноценное веб-приложение.</p>
<h1 id="design">Проектирование дашбордов</h1>
<h2 id="concept">Структура</h2>
<p>Как правило, управление персональным портфелем складывается из
трех компонентов:</p>
<ul>
<li>определение инвестиционных целей (goals);</li>
<li>формирование портфеля (portfolio);</li>
<li>мониторинг эффективности (performance).</li>
</ul>
<p>Соотвественно, наш пример будет включать три дашборда, которые
мы поместим на три отдельные вкладки.</p>
<h2 id="data_search">Данные</h2>
<p>В примере мы используем данные нескольких
популярных инвестиционных инструментах с сайта <a href="http://finance.yahoo.com/">finance.yahoo.com</a>.</p>
<p>Наш портфель будет включать 10 инструментов – акции и
облигации&nbsp;– поэтому мы возьмем по 10 тех и других, чтобы можно
было наполнять портфель в произвольной пропорции.</p>
<p> Найдем на <a href="http://finance.yahoo.com/">finance.yahoo.com</a>
20 популярных инструментов. Наш выбор не отвечает требованиям
никакой&nbsp; финансовой задачи – он просто
позволяет&nbsp;получить набор данных для нашего дашборда. </p>
<ul class="list-unstyled">
<li>Акции:
<ul>
<li><a href="http://finance.yahoo.com/q/hp?s=VTI&amp;a=11&amp;b=17&amp;c=2014&amp;d=11&amp;e=17&amp;f=2015&amp;g=d">
Vanguard Total Stock Market ETF (VTI)</a></li>
<li><a href="http://finance.yahoo.com/q/hp?s=SCHB&amp;a=11&amp;b=17&amp;c=2014&amp;d=11&amp;e=17&amp;f=2015&amp;g=d">
Schwab US Broad Market ETF (SCHB)</a></li>
<li><a href="http://finance.yahoo.com/q/hp?s=VTV&amp;a=11&amp;b=17&amp;c=2014&amp;d=11&amp;e=17&amp;f=2015&amp;g=d">
Vanguard Value ETF (VTV)</a></li>
<li><a href="http://finance.yahoo.com/q/hp?s=IVE&amp;a=11&amp;b=17&amp;c=2014&amp;d=11&amp;e=17&amp;f=2015&amp;g=d">
iShares S&amp;P 500 Value (IVE)</a></li>
<li><a href="http://finance.yahoo.com/q/hp?s=VOE&amp;a=11&amp;b=17&amp;c=2014&amp;d=11&amp;e=17&amp;f=2015&amp;g=d">
Vanguard Mid-Cap Value ETF (VOE)</a></li>
<li><a href="http://finance.yahoo.com/q/hp?s=VBR&amp;a=11&amp;b=17&amp;c=2014&amp;d=11&amp;e=17&amp;f=2015&amp;g=d">
Vanguard Small-Cap Value ETF (VBR)</a></li>
<li><a href="http://finance.yahoo.com/q/hp?s=VEA&amp;a=11&amp;b=17&amp;c=2014&amp;d=11&amp;e=17&amp;f=2015&amp;g=d">
Vanguard FTSE Developed Markets ETF (VEA)</a></li>
<li><a href="http://finance.yahoo.com/q/hp?s=VWO&amp;a=11&amp;b=17&amp;c=2014&amp;d=11&amp;e=17&amp;f=2015&amp;g=d">
Vanguard FTSE Emerging Markets ETF (VWO)</a></li>
<li><a href="http://finance.yahoo.com/q/hp?s=FPACX&amp;a=11&amp;b=17&amp;c=2014&amp;d=11&amp;e=17&amp;f=2015&amp;g=d">
FPA Crescent (FPACX)</a></li>
<li><a href="http://finance.yahoo.com/q/hp?s=WFC&amp;a=11&amp;b=17&amp;c=2014&amp;d=11&amp;e=17&amp;f=2015&amp;g=d">
Wells Fargo &amp; Company (WFC)</a></li>
</ul>
</li>
<li> Облигации:
<ul>
<li><a href="http://finance.yahoo.com/q/hp?s=MUB&amp;a=11&amp;b=17&amp;c=2014&amp;d=11&amp;e=17&amp;f=2015&amp;g=d">
iShares National AMT-Free Muni Bond (MUB)</a></li>
<li><a href="http://finance.yahoo.com/q/hp?s=LQD&amp;a=11&amp;b=17&amp;c=2014&amp;d=11&amp;e=17&amp;f=2015&amp;g=d">
iShares iBoxx $ Invst Grade Crp Bond (LQD)</a></li>
<li><a href="http://finance.yahoo.com/q/hp?s=BNDX&amp;a=11&amp;b=17&amp;c=2014&amp;d=11&amp;e=17&amp;f=2015&amp;g=d">
Vanguard Total International Bond ETF (BNDX)</a></li>
<li><a href="http://finance.yahoo.com/q/hp?s=VWOB&amp;a=11&amp;b=17&amp;c=2014&amp;d=11&amp;e=17&amp;f=2015&amp;g=d">
Vanguard Emerging Markets Govt Bd ETF (VWOB)</a></li>
<li><a href="http://finance.yahoo.com/q/hp?s=SHV&amp;a=11&amp;b=17&amp;c=2014&amp;d=11&amp;e=17&amp;f=2015&amp;g=d">
iShares Short Treasury Bond (SHV)</a></li>
<li><a href="http://finance.yahoo.com/q/hp?s=VTIP&amp;a=11&amp;b=17&amp;c=2014&amp;d=11&amp;e=17&amp;f=2015&amp;g=d">
Vanguard Short-Term Infl-Prot Secs ETF (VTIP)</a></li>
<li><a href="http://finance.yahoo.com/q/hp?s=HICOX&amp;a=11&amp;b=17&amp;c=2014&amp;d=11&amp;e=17&amp;f=2015&amp;g=d">
Colorado BondShares A Tax-Exempt (HICOX)</a></li>
<li><a href="http://finance.yahoo.com/q/hp?s=AVEFX&amp;a=11&amp;b=17&amp;c=2014&amp;d=11&amp;e=17&amp;f=2015&amp;g=d">
Ave Maria Bond (AVEFX)</a></li>
<li><a href="http://finance.yahoo.com/q/hp?s=MWSTX&amp;a=11&amp;b=17&amp;c=2014&amp;d=11&amp;e=17&amp;f=2015&amp;g=ds">
Metropolitan West Strategic Income M (MWSTX)</a></li>
<li><a href="http://finance.yahoo.com/q/hp?s=DLTNX&amp;a=11&amp;b=17&amp;c=2014&amp;d=11&amp;e=17&amp;f=2015&amp;g=d">
DoubleLine Total Return Bond N (DLTNX)</a></li>
</ul>
</li>
</ul>
<h2 id="layout_draft">Визуальное представление</h2>
<p>Как было сказано ранее, мы собираемся сделать три дашборда в
отдельных вкладках.&nbsp;Рассмотрим подробнее, какие данные,
элементы управления и графики мы хотим видеть в каждом из дашбордов.
При проектировании визуализации удобно нарисовать ее на бумаге или в
графическом редакторе&nbsp;– что мы и сделаем в следующих трех
разделах.</p>
<h3>Вкладка "Цели"</h3>
<p>Первая вкладка будет использоваться для формирования портфеля.
Очевидно,&nbsp;она должна содержать информацию о
распределении&nbsp;инвестиционных инструментов, причем так, чтобы
могли менять соотношение количества акций и облигаций в портфеле.
Привычным и наглядным способом представления подобной информации
является круговая диаграмма. Для более привлекательного визуального
представления мы используем ее вариацию, которая называется "бублик"
(donut chart). Соотношение количества инструментов удобно регулировать
с помощью ползунка. Расположим его над диаграммой.&nbsp; <img src="src/i/about_pic_1.jpg"> </p>
<p> Также в этой вкладке мы хотим видеть прогноз роста нашего
портфеля в зависимости от выбранного соотношения инвестиционных
инструментов. Используем два графика: линейный график для отображения
прогноза роста портфеля и областную диаграмму (range area) для
отображения возможных колебаний роста. Для изменения прогнозируемого
периода (от 1 года до 50 лет) используем ползунок сверху. <img src="src/i/about_pic_2.jpg"> </p>
<p> Таким образом, во вкладке "Цели" дашборд должен выглядеть
примерно так: <img src="src/i/about_pic_3.jpg"> </p>
<h3>Вкладка "Портфель"</h3>
<p>В этой вкладке мы будем видеть текущее состояние портфеля и
подробную информацию о составляющих его инструментах. Состав портфеля,
как и во вкладке "Цели" будет изображен с помощью круговой диаграммы: <img src="src/i/about_pic_4.jpg"> </p>
<p>Подробная информация об инвестицонных инструментах будет
представлена в таблице с шестью столбцами – полное название (Full
name),&nbsp;сокращенное название (Ticker), доля в&nbsp;портфеле
(Percent of Portfolio),&nbsp;количество купленных единиц (Amount),
стоимость единицы (Price), общая стоимость (Sum): <img src="src/i/about_pic_5.jpg"> </p>
<p>Итак, вторая вкладка будет выглядеть примерно так: <img src="src/i/about_pic_6.jpg"> </p>
<h3>Вкладка "Эффективность"</h3>
<p> В последней вкладке будет отслеживаться эффективность
портфеля. Для этого используем линейный график со скроллером
(распространенное название – <a href="http://www.anychart.com/products/anystock/" target="_blank">Stock Chart</a>). <img src="src/i/about_pic_7.jpg">
</p>
<p> Для сравнения эффективности нашего портфеля с другими
используем данные о нескольких известных портфелях (<a href="http://finance.yahoo.com/q/hp?s=%5EGSPC+Historical+Prices">S&amp;P
500</a>, <a href="http://finance.yahoo.com/q/hp?s=%5EIXIC+Historical+Prices">Nasdaq</a>,
<a href="http://finance.yahoo.com/q/hp?s=%5EDJI+Historical+Prices">Dow</a>)
&nbsp;с сайта <a href="http://finance.yahoo.com/">finance.yahoo.com</a>
и добавим возможность отображать их рядом с графиком эффективности
нашего портфеля в виде дополнительных линейных графиков: <img src="src/i/about_pic_8.jpg"> </p>
<h1 id="implementation">Создание дашбордов</h1>
<h2 id="converting_data">Формат данных</h2>
<p>В реальном приложении данные хранятся в той или иной базе
данных, и то, как они будут оттуда
выгружаться, зависит от СУБД, веб-сервера и
серверной платформы. В нашем примере мы используем для хранения данных
формат JSON, так как он довольно прост, известен и многие платформы
позволяют легко с ним работать.</p>
<p> Далее рассмотрим данные, которые будут использоваться в
каждой вкладке нашего
дашборда. Все они будут сохранены в папке /data в виде JSON-файлов.</p>
<h3>Вкладка "Цели"</h3>
<p>Для создания линейного графика и круговой диаграммы в этой
вкладке нам необходим список всех доступных инструментов и их
параметры. Данные, взятые с <a href="http://finance.yahoo.com/">finance.yahoo.com</a>,
мы сохранили в JSON-формате и в файле <a target="_blank" href="https://github.com/AnyChart/investment-portfolio-dashboard/blob/master/src/data/StocksViaBonds.json">StocksViaBonds.json</a>.&nbsp;</p>
<h3>Вкладка "Портфель"</h3>
<p> Для отображения круговой диаграммы и таблицы во вкладке
"Портфель" также используются данные из файла <a target="_blank" href="https://github.com/AnyChart/investment-portfolio-dashboard/blob/master/src/data/StocksViaBonds.json">StocksViaBonds.json</a>.</p>
<h3>Вкладка "Эффективность"</h3>
<p> Для построения графиков эффективности в последней вкладке нам
понадобятся исторические данные о стоимости выбранных нами инструментов
и о портфелях <a href="http://finance.yahoo.com/q/hp?s=%5EGSPC+Historical+Prices">S&amp;P
500</a>, <a href="http://finance.yahoo.com/q/hp?s=%5EIXIC+Historical+Prices">Nasdaq</a>
и
<a href="http://finance.yahoo.com/q/hp?s=%5EDJI+Historical+Prices">Dow</a>.
Мы взяли все данные с <a href="http://finance.yahoo.com/">finance.yahoo.com</a>
и сохранили в файлы <a href="https://github.com/AnyChart/investment-portfolio-dashboard/blob/master/src/data/historical.json">historical.json</a>
и <a href="https://github.com/AnyChart/investment-portfolio-dashboard/blob/master/src/data/financialQuotes.json">financialQuotes.json</a>.</p>
<h3>Using .json</h3>
<p> Для загрузки данных используем AJAX-запросы такого типа: </p>
<pre class="prettyprint">$.getJSON("https://raw.githubusercontent.com/AnyChart/investment-portfolio-dashboard/master/src/data/financialQuotes.json",<br>function (parsed_data) {<br> ...<br>});</pre>
<p>Получив исходные данные, мы выполняем все
необходимые расчеты и&nbsp;передаем
графикам преобразованные данные с помощью метода <span class="method">.data()</span>. </p>
<h2 id="layout_technology">HTML-верстка</h2>
<p>Графики в нашем примере созданы с помощью <a target="_blank" href="http://www.anychart.com/">JavaScript-библиотеки
для построения графиков AnyChart</a> (<a target="_blank" href="http://cdn.anychart.com/">последней
версии</a>). Руководство пользователя можно найти по ссылке <a target="_blank" href="http://docs.anychart.com/">AnyChart
Users' Guide</a>, API – по ссылке <a target="_blank" href="http://api.anychart.com/">AnyChart
JavaScript API Reference</a>.</p>
<p>Также в этом примере были использованы следующие библиотеки:</p>
<ul class="list-default">
<li><a target="_blank" href="http://jquery.com/">Jquery
2.1.3</a> для загрузки данных и работы с DOM;</li>
<li><a target="_blank" href="http://getbootstrap.com/getting-started/">Bootstrap 3</a>
для создания вкладок и верстки меню;</li>
<li><a target="_blank" href="http://fortawesome.github.io/Font-Awesome/get-started/">Font
Awesome 4.4.0</a> для работы с шрифтами;</li>
<li><a target="_blank" href="https://github.com/google/code-prettify">prettify.js</a>
и <a href="https://github.com/chriskempson/tomorrow-theme">prettify-tomorrow.css</a>
для отображения примеров кода;</li>
<li><a target="_blank" href="http://seiyria.com/bootstrap-slider/">Slider for
Bootstrap</a> для работы с ползунками.</li>
</ul>
<h2 id="creation">Создание графиков с помощью AnyChart</h2>
<h3>Вкладка "Цели"</h3>
<p>Во вкладке "Цели" необходимо создать два графика. Поскольку их
данные могут меняться, при загрузке страницы создадим
оба графика с нужными нам настройками и пустыми данными.</p>
<p>Функция <span class="method">drawDonutChart</span>,
приведенная ниже, создает круговую
диаграмму со всеми необходимыми настройками и пустыми данными. Она
возвращает объект, содержащий экземпляр графика (<span class="method">chart</span>),
ссылку на объект <span class="method">path</span>,
который который нам будет
нужен для создания красивого эффекта дуги вокруг диаграммы, и ссылку на
объект <span class="method">dataset</span>, с
помощью которого мы будем задавать данные.
</p>
<pre class="prettyprint linenums:1">function drawDonutChart(container_id) {<br> var chart = anychart.pie();<br> chart.interactivity('single');<br> chart.legend(false);<br> chart.radius('40%');<br> chart.innerRadius('60%');<br> chart.padding(0);<br> chart.margin(0);<br> chart.explode(0);<br> chart.labels(false);<br> var dataset = anychart.data.set();<br> chart.data(dataset);<br> var stage = anychart.graphics.create(container_id);<br> chart.container(stage);<br> var path = stage.path().stroke(null).zIndex(10);<br> chart.draw();<br> return {'chart': chart, 'path': path, 'dataset': dataset};<br></pre>
<p>Когда пользователь изменяет положение ползунков, нужно
изменить <span class="method">dataset</span>
соответствующего графика.</p>
<p>Ниже приведен код для круговой диаграммы:
</p>
<pre class="prettyprint linenums:1">function updateDonutListeners(donutData, instrumentsTable){<br> var groupIndexes = [];<br> donutData['chart'].listen('pointshover', function (e) {<br> drawHoverArc(e.point, donutData['chart'], donutData['data'], donutData['path']);<br> groupIndexes = [];<br> var colorFill = '#ffa760';<br> if (donutData['data'][e.point.index]['group'] == 'bonds') colorFill = '#6fc0fe';<br> if ($('#table-container').is(':visible')) {<br> groupIndexes = [e.point.index];<br> highLightRowInTable(groupIndexes, instrumentsTable, colorFill + ' 0.3')<br> }<br> });<br> donutData['chart'].listen('mouseout', function (e) {<br> if ($('#table-container').is(':visible')) highLightRowInTable(groupIndexes, instrumentsTable, null);<br> });<br><br> function createChartLabel(index, anchor, groupName, groupColor) {<br> var label = donutData['chart'].label(index).useHtml(true);<br> label.position('center');<br> label.fontColor(groupColor);<br> label.anchor(anchor);<br> label.offsetY(-10);<br> label.offsetX(10);<br> label.hAlign('center');<br> label.listen('mouseOver', function () {<br> document.body.style.cursor = 'pointer';<br> groupIndexes = [];<br> for (i = 0; i &lt; donutData['data'].length; i++){<br> if (donutData['data'][i]["group"] == groupName) groupIndexes.push(i)<br> }<br> if ($('#table-container').is(':visible')) highLightRowInTable(groupIndexes, instrumentsTable, groupColor + ' 0.3');<br><br> donutData['chart'].unhover();<br> donutData['chart'].hover(groupIndexes);<br> donutData['path'].clear();<br> for (var i = 0; i &lt; groupIndexes.length; i++){<br> drawHoverArc(donutData['chart'].getPoint(groupIndexes[i]), donutData['chart'], donutData['data'], donutData['path'], true);<br> }<br> });<br> label.listen('mouseOut', function () {<br> document.body.style.cursor = '';<br> donutData['chart'].unhover();<br> donutData['path'].clear();<br> if ($('#table-container').is(':visible')) highLightRowInTable(groupIndexes, instrumentsTable, null);<br> });<br> }<br> createChartLabel(0, 'left', 'stocks', '#ffa760');<br> createChartLabel(1, 'right', 'bonds', '#6fc0fe');<br>}</pre>
<p>В функции <span class="method">updateDonutListeners</span>
параметр&nbsp;<span class="method">donutData</span>
– это новые данные для диаграммы, а параметр <span class="method">instrumentsTable</span>
используется только во вкладке "Портфель", чтобы обеспечить подсветку
соответствующих строк в таблице.
</p>
<p class="alert alert-warning"> <strong>ВНИМАНИЕ:</strong>
При изменении данных в круговой диаграмме в зависимости
от желаемого соотношения инструментов в портфеле мы не решаем "задачу о
рюкзаке", а только
имитируем такое распределение инструментов. Эта имитация реализована
функцией <span class="method">getDataInProportion()</span>,
код которой здесь не приводится.
</p>
<p> Для построения линейного графика используются следующие две
функции: </p>
<p><span class="method">drawForecastChart()</span>
</p>
<pre class="prettyprint linenums:1">function drawForecastChart(container_id) {<br> var chart = anychart.area();<br> chart.tooltip().useHtml(true);<br> var lineDataset = anychart.data.set();<br> chart.spline(lineDataset).stroke('#64b5f6').tooltip()<br> .textFormatter(function(){<br> return 'Forecast: $' + this.value.toLocaleString();<br> });<br> var rangeDataset = anychart.data.set();<br> chart.rangeSplineArea(rangeDataset).fill('#64b5f6 0.3').highStroke(null).lowStroke(null).hoverMarkers(null).tooltip()<br> .textFormatter(function(){<br> return 'High: $' + this.high.toLocaleString() + 'Low: $' + this.low.toLocaleString();<br> });<br> chart.tooltip().displayMode('union');<br> chart.yAxis().labels().textFormatter(function(){return '$' + this.value.toLocaleString()});<br> chart.container(container_id);<br> chart.draw();<br> return {'chart': chart, 'lineDataset': lineDataset, 'rangeDataset': rangeDataset};<br>}</pre>
<p><span class="method">updateForecastData()</span>
</p>
<pre class="prettyprint linenums:1">function updateForecastData(forecastData){<br> var time_data = [];<br> var approximate_data = [];<br> var year = new Date().getFullYear();<br> for (var i = 0; i &lt;= forecastData['length']; i++){<br> var item = 0;<br> for (var j = 0; j &lt; forecastData['data'].length; j++){<br> item = item + forecastData['data'][j]['value'] * Math.pow((1 + forecastData['data'][j]['coefficient'] / 100), i);<br> }<br> time_data.push({x: year + i, value: item.toFixed(2)});<br> var shadow = i / 200;<br> approximate_data.push({x: year + i, low: item.toFixed(2) * (1 - shadow), high: item.toFixed(2) * (1 + shadow)});<br> }<br> if (forecastData['length'] &gt; 0) forecastData['chart'].xScale().ticks().interval(1);<br> if (forecastData['length'] &gt; 10) forecastData['chart'].xScale().ticks().interval(2);<br> if (forecastData['length'] &gt;= 20) forecastData['chart'].xScale().ticks().interval(5);<br> forecastData['lineDataset'].data(time_data);<br> forecastData['rangeDataset'].data(approximate_data);<br>}</pre>
<h3>Вкладка "Портфель"</h3>
<p>Во вкладке "Портфель" мы создаем круговую диаграмму и таблицу
с подробной информацией об инструментах. Для создания диаграммы
используется та же функция, что и во вкладке "Цели", а таблица
создается и обновляется следующими двумя функциями: </p>
<p><span class="method">drawTable()</span>
</p>
<pre class="prettyprint linenums:1">function drawTable(container_id){<br> var table = anychart.ui.table();<br> table.container(container_id);<br> table.cellBorder(null);<br> table.cellBorder().bottom('1px #dedede');<br> table.fontSize(12).vAlign('middle').hAlign('left').fontColor('#212121');<br> table.contents([['Name', 'Ticker', 'Percent', 'Price', 'Amount', 'Total Sum']]);<br> table.getCol(0).fontSize(11);<br> table.getRow(0).cellBorder().bottom('2px #dedede').fontColor('#7c868e').height(50).fontSize(12);<br> table.getCol(1).width(60);<br> table.getCol(2).width(60);<br> table.getCol(3).width(75);<br> table.getCol(4).width(60);<br> table.getCol(5).width(90);<br> table.draw();<br> return table;<br>}</pre>
<p><span class="method">updateTableData()</span>
</p>
<pre class="prettyprint linenums:1">function updateTableData(table, data){<br> var contents = [<br> ['Name', 'Ticker', 'Percent', 'Price', 'Amount', 'Total Sum']<br> ];<br> for (var i = 0; i &lt; data.length; i++){<br> contents.push([<br> data[i]['name'],<br> data[i]['ticker'],<br> data[i]['percent'] + '%',<br> '$' + parseFloat(data[i]['price']).toLocaleString(),<br> data[i]['amount'],<br> '$' + parseFloat(data[i]['value']).toLocaleString()<br> ]);<br> }<br> table.contents(contents);<br> table.draw();<br>}<br></pre>
<h3>Вкладка "Эффективность"</h3>
<p>Ниже приведены функции создания и обновления данных графика из
вкладки "Эффективность". Можно заметить, что там используются
вспомогательные функции для перерасчета данных и других целей. Мы не
будем рассматривать их подробно&nbsp;– если вы хотите узнать, как
устроены эти функции, загляните в исходный код примера.
</p>
<p><span class="method">drawStockChart()</span>
</p>
<pre class="prettyprint linenums:1">function drawStockChart(container_id){<br> var stock = anychart.stock();<br> var plot = stock.plot();<br> plot.yAxis(1).orientation('right');<br> stock.padding(0, 80, 0, 80);<br> stock.container(container_id);<br><br> var mainTable = anychart.data.table('date');<br> var mainMapping = mainTable.mapAs({value: {column: 'value', type: 'close'}});<br> plot.line(mainMapping).name('Portfolio').stroke('2 #1976d2');<br><br> var SP500Table = anychart.data.table('date');<br> var SP500Mapping = SP500Table.mapAs({value: {column: 'value', type: 'close'}});<br> var SP500Series = plot.line(SP500Mapping).name('S&amp;P 500').stroke('1 #ef6c00');<br><br> var DowTable = anychart.data.table('date');<br> var DowMapping = DowTable.mapAs({value: {column: 'value', type: 'close'}});<br> var DowSeries = plot.line(DowMapping).name('Dow').stroke('1 #ffa000');<br><br> var NasdaqTable = anychart.data.table('date');<br> var NasdaqMapping = NasdaqTable.mapAs({value: {column: 'value', type: 'close'}});<br> var NasdaqSeries = plot.line(NasdaqMapping).name('NASDAQ').stroke('1 #ffd54f');<br><br> stock.scroller().line(mainMapping);<br> stock.draw();<br> return {'stock': stock, 'mainTable': mainTable,<br> 'SP500Table': SP500Table, 'DowTable': DowTable, 'NasdaqTable': NasdaqTable,<br> 'SP500': SP500Series, 'Dow': DowSeries, 'NASDAQ': NasdaqSeries};<br>}</pre>
<p><span class="method">changeStockChart()</span>
</p>
<pre class="prettyprint linenums:1">function changeStockChart(stockData){<br> stockData['mainTable'].remove();<br> var initial_sum = stockData['mainData'][stockData['mainData'].length - 1].value;<br> stockData['mainTable'].addData(stockData['mainData']);<br> stockData['SP500Table'].addData(calculateIndexPrices(stockData['indexesData']['S&amp;P 500'], initial_sum));<br> stockData['DowTable'].addData(calculateIndexPrices(stockData['indexesData']['Dow'], initial_sum));<br> stockData['NasdaqTable'].addData(calculateIndexPrices(stockData['indexesData']['NASDAQ'], initial_sum));<br>}</pre>
<h2 id="enjoying">Результаты</h2>
<p>Вы можете увидеть готовый дашбоард по ссылке <a href="index.html">Дашбоард: Управление инвестиционным
портфелем</a>.
</p>
<h1 id="licence">Лицензия</h1>
<p> Код примера и и данные в нем лицензируются под <a target="_blank" href="http://www.apache.org/licenses/LICENSE-2.0">Apache 2.0
License</a>, AnyChart, Bootstrap, JQuery и Font Awesome
лицензируются отдельно.</p>
<p> Репозиторий примера на GitHub: <a href="https://github.com/AnyChart/investment-portfolio-dashboard">AnyChart Investment Portfolio Dashboard</a>.
</p>
</div>
</div>
<div class="row footer-panel">
<div class="footer"> <span class="pull-left"><a class="footer-credits-link" href="https://github.com/AnyChart/investment-portfolio-dashboard">View
on GitHub </a></span> <span class="pull-right">©
2015 <a class="footer-credits-link" href="//anychart.com">AnyChart.com
- JavaScript charts</a>. All rights reserved</span> </div>
</div>
</div>
</div>
<script src="src/vendors/jquery/jquery-2.1.3.min.js"></script>
<script src="src/vendors/bootstrap-3/bootstrap.min.js"></script>
<script src="src/vendors/prettify.js"></script>
<script>
$(function () {
prettyPrint();
});
</script>
</body></html>
